---
layout: default
title: API - Request
---

<h1>Request</h1>

<p>
  A <code>Request</code> instance represents a request that can be executed on a connection.
</p>

<ul class="toc">
  <li><a href="#function_newRequest">new Request(sql, callback)</a></li>
  <li><a href="#event_columnMetadata">Event: columnMetadata</a></li>
  <li><a href="#event_row">Event: 'row'</a></li>
  <li><a href="#event_done">Event: 'done'</a></li>
  <li><a href="#event_doneInProc">Event: 'doneInProc'</a></li>
  <li><a href="#event_doneProc">Event: 'doneProc'</a></li>
</ul>

<h2 id="function_newRequest">new Request(sql, callback)</h3>
{% highlight javascript %}
var Request = require('tedious').Request;

request = new Request("select 42, 'hello world'", myErrorFunction);
connection.execSql(request);
{% endhighlight %}

<div class="argument">
  <div class="name">sql</div>
  <div class="description">
    <p>
      The SQL to be executed.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">callback</div>
  <div class="description">
  <span class="function">function (err) { }</span>
    <p>
      If an error occurs during execution of the statement(s), then the callback will be called.
    </p>
    <div class="argument">
      <div class="name">err</div>
      <div class="description">
        <p>
          A string with details of the error.
        </p>
      </div>
    </div>
  </div>
</div>

<h2 id="event_columnMetadata">Event: columnMetadata</h2>
<code>function (columns) { }</code>
<p>
  This event, describing result set columns, will be emitted before <code>row</code> events are emitted.
</p>
<div class="argument">
  <div class="name">columns</div>
  <div class="description">
    <p>
      An array like object, where the columns can be accessed either by index or name.
      Each column has these properties.
    </p>
    <dl>
      <dt>
        <code>colName</code>
      </dt>
      <dd>
        The column's name.
      </dd>

      <dt>
        <code>type.name</code>
      </dt>
      <dd>
        The column's type, such as VarChar, Int or Binary.
      </dd>

      <dt>
        <code>precision</code>
      </dt>
      <dd>
        The precision. Only applicable to types such as numeric and decimal.
      </dd>

      <dt>
        <code>scale</code>
      </dt>
      <dd>
        The scale. Only applicable to types such as numeric and decimal.
      </dd>

      <dt>
        <code>dataLength</code>
      </dt>
      <dd>
        The length, for types such as char, varchar, narchar and nvarchar.
      </dd>
    </dl>
  </div>
</div>

<h2 id="event_row">Event: row</h2>
<code>function (columns) { }</code>
<p>
  A row resulting from execution of the SQL.
</p>
<div class="argument">
  <div class="name">columns</div>
  <div class="description">
    <p>
      An array like object, where the columns can be accessed either by index or name.
      Each column has two properties, <code>metadata</code> and <code>value</code>.
    </p>
    <dl>
      <dt>
        <code>metadata</code>
      </dt>
      <dd>
        The same data that is exposed in the <code>columnMetadata</code> event.
      </dd>

      <dt>
        <code>value</code>
      </dt>
      <dd>
        The column's value.
        It will be <code>null</code> for a <code>NULL</code>.
      </dd>
    </dl>
  </div>
</div>

<h2 id="event_done">Event: done</h2>
<code>function (rowCount, more) { }</code>
<p>
  All rows from a result set have been provided (through <code>row</code> events).
</p>
<div class="argument">
  <div class="name">rowCount</div>
  <div class="description">
    <p>
      The number of result rows.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">more</div>
  <div class="description">
    <p>
      If there are more results to come (probably because multiple statements are being executed),
      then <code>true</code>.
    </p>
  </div>
</div>

<h2 id="event_doneInProc">Event: doneInProc</h2>
<code>function (rowCount, more) { }</code>
<p>
  All rows from a statement in a stored procedure have been provided (through <code>row</code> events).
</p>
<div class="argument">
  <div class="name">rowCount</div>
  <div class="description">
    <p>
      The number of result rows.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">more</div>
  <div class="description">
    <p>
      If there are more result sets to come,
      then <code>true</code>.
    </p>
  </div>
</div>

<h2 id="event_doneProc">Event: doneProc</h2>
<code>function (rowCount, more, returnStatus) { }</code>
</p>
  A stored procedure has been completed.
</p>
<div class="argument">
  <div class="name">rowCount</div>
  <div class="description">
    <p>
      The number of result rows.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">more</div>
  <div class="description">
    <p>
      If there are more result sets to come,
      then <code>true</code>.
    </p>
  </div>
</div>
<div class="argument">
  <div class="name">returnStatus</div>
  <div class="description">
    <p>
      The value returned from a stored procedure.
    </p>
  </div>
</div>
